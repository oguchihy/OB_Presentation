---
title: "Test Shiny in Quarto"
format: html
server: shiny
---

<!-- ```{r}  -->
<!-- library(shiny) -->
<!-- library(dplyr) -->
<!-- library(tableone) -->
<!-- ``` -->

```{r}
selectInput("variable", "Select a Variable:", choices = names(mtcars))
actionButton("update", "Update Table")
tableOutput("table_one")
```

```{r}
#| context: server
selected_var <- reactive({
  req(input$variable)
  input$variable
})

table_one_data <- eventReactive(input$update, {
  tableone::CreateTableOne(data = mtcars, vars = selected_var())
})

output$table_one <- renderTable({
  table_df <- as.data.frame(print(table_one_data(), printToggle = FALSE))
  table_df
}, rownames = TRUE)